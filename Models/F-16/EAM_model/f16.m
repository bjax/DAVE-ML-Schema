function [y,x] = f16(u,t,x0,c)%%  function [y,x] = f16(u,t,x0,c)%%  Usage: [y,x] = f16(u,t,x0,c);%%%  Description:%%    Computes the state and output vector time histories for the %    F-16 nonlinear simulation based on NASA TP-1538, December 1979.%%  Input:%    %    u = input vector = [ thtl  (0 <= thtl <= 1.0)%                          el   (deg)%                          ail  (deg)%                          rdr  (deg) ];%    t = time vector. %   x0 = state vector initial condition.%    c = vector of constants:  c(1) through c(9) = inertia constants.%                              c(10) = aircraft mass, slugs.%                              c(11) = xcg, longitudinal c.g. location,%                                      distance normalized by the m.a.c.%%  Output:%%     y = output vector time history = x.%     x = state vector = [   vt  (ft/sec)%                          alpha (rad)%                           beta (rad)%                            phi (rad)%                            the (rad)%                            psi (rad)%                             p  (rad/sec)%                             q  (rad/sec)%                             r  (rad/sec)%                            xe  (ft)%                            ye  (ft)%                             h  (ft)  %                            pow (percent, 0 <= pow <= 100) ];%%%    Calls:%      f16_aero_setup.m%      f16_engine_setup.m%      rk2.m or rk4.m or ab2.m%      f16_deq.m%%    Author:  Eugene A. Morelli%%    History:  %      17 June 1995 - Created and debugged, EAM.%%%  Copyright (C) 2000  Eugene A. Morelli%%%  This program carries no warranty, not even the implied %  warranty of merchantability or fitness for a particular purpose.  %%  Please email bug reports or suggestions for improvements to:%%      e.a.morelli@larc.nasa.gov%%%  Check input dimensions.%[npts,ni]=size(u);if ni~=4  fprintf('\n Error:  missing input channel(s) \n\n')  returnendif npts~=length(t)  fprintf('\n Error:  length of u and t not compatible \n\n')  returnendif length(x0) < 13  fprintf('\n Error:  missing x0 vector elements \n\n')  returnendif length(c) < 11  fprintf('\n Error:  missing c vector elements \n\n')  returnend%%  Aerodynamic data.%f16_aero_setup;%%  Engine data.%f16_engine_setup;%%  Integration decreases by approximately%  a factor of two from rk4 (near real time)%  to rk2 (runs in about half real time) %  to ab2 (runs in about one-fourth real time).  %%x=rk4('f16_deq',u,t,x0,c);x=rk2('f16_deq',u,t,x0,c);%x=ab2('f16_deq',u,t,x0,c);y=x;return